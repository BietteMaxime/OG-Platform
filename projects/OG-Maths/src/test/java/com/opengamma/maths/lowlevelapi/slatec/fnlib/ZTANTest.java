/**
 * Copyright (C) 2013 - present by OpenGamma Inc. and the OpenGamma group of companies
 * 
 * Please see distribution for license.
 */
package com.opengamma.maths.lowlevelapi.slatec.fnlib;

import static org.testng.Assert.assertTrue;

import org.testng.annotations.Test;

import com.opengamma.maths.commonapi.MathsConstants;
import com.opengamma.maths.commonapi.exceptions.MathsExceptionIllegalArgument;
import com.opengamma.maths.commonapi.numbers.ComplexType;
import com.opengamma.maths.highlevelapi.datatypes.primitive.OGComplexMatrix;
import com.opengamma.maths.lowlevelapi.linearalgebra.blas.referenceblas.D1mach;

/**
 * Tests complex square root
 */
@Test
public class ZTANTest {
  private static double[][] realP = { {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 } };

  private static double[][] imagP = {
      {-10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00 },
      {-9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00 },
      {-8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00 },
      {-7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00 },
      {-6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00 },
      {-5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00 },
      {-4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00 },
      {-3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00 },
      {-2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00 },
      {-1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00 },
      {0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00 },
      {1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00 },
      {2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00 },
      {3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00 },
      {4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00 },
      {5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00 },
      {6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00 },
      {7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00 },
      {8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00 },
      {9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00 },
      {10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00 } };

  private static double[][] answerReal = {
      {-0.0000000037634409, 0.0000000030958002, 0.0000000011868259, -0.0000000040835880, 0.0000000022119185, 0.0000000022426222, -0.0000000040784388, 0.0000000011518365, 0.0000000031197725,
          -0.0000000037484034, 0.0000000000000000, 0.0000000037484034, -0.0000000031197725, -0.0000000011518365, 0.0000000040784388, -0.0000000022426222, -0.0000000022119185, 0.0000000040835880,
          -0.0000000011868259, -0.0000000030958002, 0.0000000037634409 },
      {-0.0000000278082750, 0.0000000228750406, 0.0000000087695236, -0.0000000301738597, 0.0000000163439889, 0.0000000165708614, -0.0000000301358122, 0.0000000085109845, 0.0000000230521738,
          -0.0000000276971632, 0.0000000000000000, 0.0000000276971632, -0.0000000230521738, -0.0000000085109845, 0.0000000301358122, -0.0000000165708614, -0.0000000163439889, 0.0000000301738597,
          -0.0000000087695236, -0.0000000228750406, 0.0000000278082750 },
      {-0.0000002054768878, 0.0000001690249370, 0.0000000647985141, -0.0000002229563369, 0.0000001207666312, 0.0000001224430447, -0.0000002226752136, 0.0000000628881302, 0.0000001703338272,
          -0.0000002046559088, 0.0000000000000000, 0.0000002046559088, -0.0000001703338272, -0.0000000628881302, 0.0000002226752136, -0.0000001224430447, -0.0000001207666312, 0.0000002229563369,
          -0.0000000647985141, -0.0000001690249370, 0.0000002054768878 },
      {-0.0000015182793595, 0.0000012489335552, 0.0000004788005148, -0.0000016474365566, 0.0000008923503301, 0.0000009047396174, -0.0000016453599891, 0.0000004646832806, 0.0000012586073872,
          -0.0000015122148958, 0.0000000000000000, 0.0000015122148958, -0.0000012586073872, -0.0000004646832806, 0.0000016453599891, -0.0000009047396174, -0.0000008923503301, 0.0000016474365566,
          -0.0000004788005148, -0.0000012489335552, 0.0000015182793595 },
      {-0.0000112186027166, 0.0000092283753559, 0.0000035379198642, -0.0000121729834498, 0.0000065935675293, 0.0000066852313903, -0.0000121576760586, 0.0000034335357992, 0.0000092999851808,
          -0.0000111738901060, 0.0000000000000000, 0.0000111738901060, -0.0000092999851808, -0.0000034335357992, 0.0000121576760586, -0.0000066852313903, -0.0000065935675293, 0.0000121729834498,
          -0.0000035379198642, -0.0000092283753559, 0.0000112186027166 },
      {-0.0000828922288776, 0.0000681854481994, 0.0000261438540039, -0.0000899458918131, 0.0000487170126927, 0.0000494008040731, -0.0000898347764697, 0.0000253686762077, 0.0000687216388013,
          -0.0000825671983423, 0.0000000000000000, 0.0000825671983423, -0.0000687216388013, -0.0000253686762077, 0.0000898347764697, -0.0000494008040731, -0.0000487170126927, 0.0000899458918131,
          -0.0000261438540039, -0.0000681854481994, 0.0000828922288776 },
      {-0.0006123503000122, 0.0005036331328300, 0.0001932857742051, -0.0006645624514749, 0.0003597965782917, 0.0003652030545113, -0.0006638501648111, 0.0001873462046295, 0.0005079806234701,
          -0.0006102409213763, 0.0000000000000000, 0.0006102409213763, -0.0005079806234701, -0.0001873462046295, 0.0006638501648111, -0.0003652030545113, -0.0003597965782917, 0.0006645624514749,
          -0.0001932857742051, -0.0005036331328300, 0.0006123503000122 },
      {-0.0045167645782932, 0.0037108521850910, 0.0014340815816164, -0.0049075833952323, 0.0026489645969456, 0.0027082358362241, -0.0049082580674961, 0.0013786327196593, 0.0037640256415043,
          -0.0045171372766584, 0.0000000000000000, 0.0045171372766584, -0.0037640256415043, -0.0013786327196593, 0.0049082580674961, -0.0027082358362241, -0.0026489645969456, 0.0049075833952323,
          -0.0014340815816164, -0.0037108521850910, 0.0045167645782932 },
      {-0.0329389117598425, 0.0268511331123278, 0.0109258843357525, -0.0360943135932624, 0.0190597919760790, 0.0205530165682557, -0.0364233692474037, 0.0098843750383225, 0.0283929528682323,
          -0.0338128260798966, 0.0000000000000000, 0.0338128260798966, -0.0283929528682323, -0.0098843750383225, 0.0364233692474037, -0.0205530165682557, -0.0190597919760790, 0.0360943135932624,
          -0.0109258843357525, -0.0268511331123278, 0.0329389117598425 },
      {-0.2189171332996752, 0.1698100941188627, 0.1026563021580746, -0.2540714033150390, 0.1164930816631243, 0.1861094776473042, -0.2735530828073074, 0.0591685395660507, 0.2434582011857253,
          -0.2717525853195117, 0.0000000000000000, 0.2717525853195117, -0.2434582011857253, -0.0591685395660507, 0.2735530828073074, -0.1861094776473042, -0.1164930816631243, 0.2540714033150390,
          -0.1026563021580746, -0.1698100941188627, 0.2189171332996752 },
      {-0.6483608274590866, 0.4523156594418098, 6.7997114552203790, -0.8714479827243187, 0.2910061913847491, 3.3805150062465859, -1.1578212823495777, 0.1425465430742778, 2.1850398632615189,
          -1.5574077246549023, 0.0000000000000000, 1.5574077246549023, -2.1850398632615189, -0.1425465430742778, 1.1578212823495777, -3.3805150062465859, -0.2910061913847491, 0.8714479827243187,
          -6.7997114552203790, -0.4523156594418098, 0.6483608274590866 },
      {-0.2189171332996752, 0.1698100941188627, 0.1026563021580746, -0.2540714033150390, 0.1164930816631243, 0.1861094776473042, -0.2735530828073074, 0.0591685395660507, 0.2434582011857253,
          -0.2717525853195117, 0.0000000000000000, 0.2717525853195117, -0.2434582011857253, -0.0591685395660507, 0.2735530828073074, -0.1861094776473042, -0.1164930816631243, 0.2540714033150390,
          -0.1026563021580746, -0.1698100941188627, 0.2189171332996752 },
      {-0.0329389117598425, 0.0268511331123278, 0.0109258843357525, -0.0360943135932624, 0.0190597919760790, 0.0205530165682557, -0.0364233692474037, 0.0098843750383225, 0.0283929528682323,
          -0.0338128260798966, 0.0000000000000000, 0.0338128260798966, -0.0283929528682323, -0.0098843750383225, 0.0364233692474037, -0.0205530165682557, -0.0190597919760790, 0.0360943135932624,
          -0.0109258843357525, -0.0268511331123278, 0.0329389117598425 },
      {-0.0045167645782932, 0.0037108521850910, 0.0014340815816164, -0.0049075833952323, 0.0026489645969456, 0.0027082358362241, -0.0049082580674961, 0.0013786327196593, 0.0037640256415043,
          -0.0045171372766584, 0.0000000000000000, 0.0045171372766584, -0.0037640256415043, -0.0013786327196593, 0.0049082580674961, -0.0027082358362241, -0.0026489645969456, 0.0049075833952323,
          -0.0014340815816164, -0.0037108521850910, 0.0045167645782932 },
      {-0.0006123503000122, 0.0005036331328300, 0.0001932857742051, -0.0006645624514749, 0.0003597965782917, 0.0003652030545113, -0.0006638501648111, 0.0001873462046295, 0.0005079806234701,
          -0.0006102409213763, 0.0000000000000000, 0.0006102409213763, -0.0005079806234701, -0.0001873462046295, 0.0006638501648111, -0.0003652030545113, -0.0003597965782917, 0.0006645624514749,
          -0.0001932857742051, -0.0005036331328300, 0.0006123503000122 },
      {-0.0000828922288776, 0.0000681854481994, 0.0000261438540039, -0.0000899458918131, 0.0000487170126927, 0.0000494008040731, -0.0000898347764697, 0.0000253686762077, 0.0000687216388013,
          -0.0000825671983423, 0.0000000000000000, 0.0000825671983423, -0.0000687216388013, -0.0000253686762077, 0.0000898347764697, -0.0000494008040731, -0.0000487170126927, 0.0000899458918131,
          -0.0000261438540039, -0.0000681854481994, 0.0000828922288776 },
      {-0.0000112186027166, 0.0000092283753559, 0.0000035379198642, -0.0000121729834498, 0.0000065935675293, 0.0000066852313903, -0.0000121576760586, 0.0000034335357992, 0.0000092999851808,
          -0.0000111738901060, 0.0000000000000000, 0.0000111738901060, -0.0000092999851808, -0.0000034335357992, 0.0000121576760586, -0.0000066852313903, -0.0000065935675293, 0.0000121729834498,
          -0.0000035379198642, -0.0000092283753559, 0.0000112186027166 },
      {-0.0000015182793595, 0.0000012489335552, 0.0000004788005148, -0.0000016474365566, 0.0000008923503301, 0.0000009047396174, -0.0000016453599891, 0.0000004646832806, 0.0000012586073872,
          -0.0000015122148958, 0.0000000000000000, 0.0000015122148958, -0.0000012586073872, -0.0000004646832806, 0.0000016453599891, -0.0000009047396174, -0.0000008923503301, 0.0000016474365566,
          -0.0000004788005148, -0.0000012489335552, 0.0000015182793595 },
      {-0.0000002054768878, 0.0000001690249370, 0.0000000647985141, -0.0000002229563369, 0.0000001207666312, 0.0000001224430447, -0.0000002226752136, 0.0000000628881302, 0.0000001703338272,
          -0.0000002046559088, 0.0000000000000000, 0.0000002046559088, -0.0000001703338272, -0.0000000628881302, 0.0000002226752136, -0.0000001224430447, -0.0000001207666312, 0.0000002229563369,
          -0.0000000647985141, -0.0000001690249370, 0.0000002054768878 },
      {-0.0000000278082750, 0.0000000228750406, 0.0000000087695236, -0.0000000301738597, 0.0000000163439889, 0.0000000165708614, -0.0000000301358122, 0.0000000085109845, 0.0000000230521738,
          -0.0000000276971632, 0.0000000000000000, 0.0000000276971632, -0.0000000230521738, -0.0000000085109845, 0.0000000301358122, -0.0000000165708614, -0.0000000163439889, 0.0000000301738597,
          -0.0000000087695236, -0.0000000228750406, 0.0000000278082750 },
      {-0.0000000037634409, 0.0000000030958002, 0.0000000011868259, -0.0000000040835880, 0.0000000022119185, 0.0000000022426222, -0.0000000040784388, 0.0000000011518365, 0.0000000031197725,
          -0.0000000037484034, 0.0000000000000000, 0.0000000037484034, -0.0000000031197725, -0.0000000011518365, 0.0000000040784388, -0.0000000022426222, -0.0000000022119185, 0.0000000040835880,
          -0.0000000011868259, -0.0000000030958002, 0.0000000037634409 } };

  private static double[][] answerImag = {
      {-0.9999999983177603, -0.9999999972779716, -1.0000000039477668, -0.9999999994363271, -0.9999999965213747, -1.0000000034589107, -1.0000000005997958, -0.9999999960418831, -1.0000000026945199,
          -1.0000000017154851, -0.9999999958776927, -1.0000000017154851, -1.0000000026945199, -0.9999999960418831, -1.0000000005997958, -1.0000000034589107, -0.9999999965213747, -0.9999999994363271,
          -1.0000000039477668, -0.9999999972779716, -0.9999999983177603 },
      {-0.9999999875698367, -0.9999999798867797, -1.0000000291702693, -0.9999999958349893, -0.9999999742962429, -1.0000000255580850, -1.0000000044319246, -0.9999999707532523, -1.0000000199099581,
          -1.0000000126758153, -0.9999999695400410, -1.0000000126758153, -1.0000000199099581, -0.9999999707532523, -1.0000000044319246, -1.0000000255580850, -0.9999999742962429, -0.9999999958349893,
          -1.0000000291702693, -0.9999999798867797, -0.9999999875698367 },
      {-0.9999999081528108, -0.9999998513822845, -1.0000002155407750, -0.9999999692244820, -0.9999998100735054, -1.0000001888501326, -1.0000000327477192, -0.9999997838941594, -1.0000001471157944,
          -1.0000000936622973, -0.9999997749296758, -1.0000000936622973, -1.0000001471157944, -0.9999997838941594, -1.0000000327477192, -1.0000001888501326, -0.9999998100735054, -0.9999999692244820,
          -1.0000002155407750, -0.9999998513822845, -0.9999999081528108 },
      {-0.9999993213351693, -0.9999989018552098, -1.0000015926438757, -0.9999997725968210, -0.9999985966229836, -1.0000013954247118, -1.0000002419735892, -0.9999984031828296, -1.0000010870466844,
          -1.0000006920751880, -0.9999983369439447, -1.0000006920751880, -1.0000010870466844, -0.9999984031828296, -1.0000002419735892, -1.0000013954247118, -0.9999985966229836, -0.9999997725968210,
          -1.0000015926438757, -0.9999989018552098, -0.9999993213351693 },
      {-0.9999949852639540, -0.9999918857381870, -1.0000117681894050, -0.9999983196423103, -0.9999896303961914, -1.0000103108981198, -1.0000017878939043, -0.9999882010834399, -1.0000080322394338,
          -1.0000051137397155, -0.9999877116507956, -1.0000051137397155, -1.0000080322394338, -0.9999882010834399, -1.0000017878939043, -1.0000103108981198, -0.9999896303961914, -0.9999983196423103,
          -1.0000117681894050, -0.9999918857381870, -0.9999949852639540 },
      {-0.9999629434569672, -0.9999400428082992, -1.0000869587853309, -0.9999875803117126, -0.9999233799277076, -1.0000761892591823, -1.0000132074347847, -0.9999128201513537, -1.0000593501490000,
          -1.0000377833796006, -0.9999092042625951, -1.0000377833796006, -1.0000593501490000, -0.9999128201513537, -1.0000132074347847, -1.0000761892591823, -0.9999233799277076, -0.9999875803117126,
          -1.0000869587853309, -0.9999400428082992, -0.9999629434569672 },
      {-0.9997260574022129, -0.9995569481053673, -1.0006427057390959, -0.9999080429230788, -0.9994339325466380, -1.0005630461157933, -1.0000974040746433, -0.9993559873814732, -1.0004385132020523,
          -1.0002790562344654, -0.9993292997390670, -1.0002790562344654, -1.0004385132020523, -0.9993559873814732, -1.0000974040746433, -1.0005630461157933, -0.9994339325466380, -0.9999080429230788,
          -1.0006427057390959, -0.9995569481053673, -0.9997260574022129 },
      {-0.9979687647858537, -0.9967249297599343, -1.0047578718620451, -0.9993103079835998, -0.9958218066674146, -1.0041647106948151, -1.0007095360672331, -0.9952503011786029, -1.0032386273536098,
          -1.0020549882458116, -0.9950547536867305, -1.0020549882458116, -1.0032386273536098, -0.9952503011786029, -1.0007095360672331, -1.0041647106948151, -0.9958218066674146, -0.9993103079835998,
          -1.0047578718620451, -0.9967249297599343, -0.9979687647858537 },
      {-0.9846156423653740, -0.9757358762541879, -1.0356479469632378, -0.9943504089532538, -0.9693745758917580, -1.0310080051524912, -1.0046823121902353, -0.9653858790221331, -1.0238355945704727,
          -1.0147936161466335, -0.9640275800758169, -1.0147936161466335, -1.0238355945704727, -0.9653858790221331, -1.0046823121902353, -1.0310080051524912, -0.9693745758917580, -0.9943504089532538,
          -1.0356479469632378, -0.9757358762541879, -0.9846156423653740 },
      {-0.8696927693431206, -0.8200905006842617, -1.2932121874311113, -0.9302187270788691, -0.7874123562675459, -1.2407479829240700, -1.0028105075835050, -0.7680176472869111, -1.1667362572409199,
          -1.0839233273386943, -0.7615941559557649, -1.0839233273386943, -1.1667362572409199, -0.7680176472869111, -1.0028105075835050, -1.2407479829240700, -0.7874123562675459, -0.9302187270788691,
          -1.2932121874311113, -0.8200905006842617, -0.8696927693431206 },
      {0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000,
          0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000,
          0.0000000000000000, 0.0000000000000000, 0.0000000000000000 },
      {0.8696927693431206, 0.8200905006842617, 1.2932121874311113, 0.9302187270788691, 0.7874123562675459, 1.2407479829240700, 1.0028105075835050, 0.7680176472869111, 1.1667362572409199,
          1.0839233273386943, 0.7615941559557649, 1.0839233273386943, 1.1667362572409199, 0.7680176472869111, 1.0028105075835050, 1.2407479829240700, 0.7874123562675459, 0.9302187270788691,
          1.2932121874311113, 0.8200905006842617, 0.8696927693431206 },
      {0.9846156423653740, 0.9757358762541879, 1.0356479469632378, 0.9943504089532538, 0.9693745758917580, 1.0310080051524912, 1.0046823121902353, 0.9653858790221331, 1.0238355945704727,
          1.0147936161466335, 0.9640275800758169, 1.0147936161466335, 1.0238355945704727, 0.9653858790221331, 1.0046823121902353, 1.0310080051524912, 0.9693745758917580, 0.9943504089532538,
          1.0356479469632378, 0.9757358762541879, 0.9846156423653740 },
      {0.9979687647858537, 0.9967249297599343, 1.0047578718620451, 0.9993103079835998, 0.9958218066674146, 1.0041647106948151, 1.0007095360672331, 0.9952503011786029, 1.0032386273536098,
          1.0020549882458116, 0.9950547536867305, 1.0020549882458116, 1.0032386273536098, 0.9952503011786029, 1.0007095360672331, 1.0041647106948151, 0.9958218066674146, 0.9993103079835998,
          1.0047578718620451, 0.9967249297599343, 0.9979687647858537 },
      {0.9997260574022129, 0.9995569481053673, 1.0006427057390959, 0.9999080429230788, 0.9994339325466380, 1.0005630461157933, 1.0000974040746433, 0.9993559873814732, 1.0004385132020523,
          1.0002790562344654, 0.9993292997390670, 1.0002790562344654, 1.0004385132020523, 0.9993559873814732, 1.0000974040746433, 1.0005630461157933, 0.9994339325466380, 0.9999080429230788,
          1.0006427057390959, 0.9995569481053673, 0.9997260574022129 },
      {0.9999629434569672, 0.9999400428082992, 1.0000869587853309, 0.9999875803117126, 0.9999233799277076, 1.0000761892591823, 1.0000132074347847, 0.9999128201513537, 1.0000593501490000,
          1.0000377833796006, 0.9999092042625951, 1.0000377833796006, 1.0000593501490000, 0.9999128201513537, 1.0000132074347847, 1.0000761892591823, 0.9999233799277076, 0.9999875803117126,
          1.0000869587853309, 0.9999400428082992, 0.9999629434569672 },
      {0.9999949852639540, 0.9999918857381870, 1.0000117681894050, 0.9999983196423103, 0.9999896303961914, 1.0000103108981198, 1.0000017878939043, 0.9999882010834399, 1.0000080322394338,
          1.0000051137397155, 0.9999877116507956, 1.0000051137397155, 1.0000080322394338, 0.9999882010834399, 1.0000017878939043, 1.0000103108981198, 0.9999896303961914, 0.9999983196423103,
          1.0000117681894050, 0.9999918857381870, 0.9999949852639540 },
      {0.9999993213351693, 0.9999989018552098, 1.0000015926438757, 0.9999997725968210, 0.9999985966229836, 1.0000013954247118, 1.0000002419735892, 0.9999984031828296, 1.0000010870466844,
          1.0000006920751880, 0.9999983369439447, 1.0000006920751880, 1.0000010870466844, 0.9999984031828296, 1.0000002419735892, 1.0000013954247118, 0.9999985966229836, 0.9999997725968210,
          1.0000015926438757, 0.9999989018552098, 0.9999993213351693 },
      {0.9999999081528108, 0.9999998513822845, 1.0000002155407750, 0.9999999692244820, 0.9999998100735054, 1.0000001888501326, 1.0000000327477192, 0.9999997838941594, 1.0000001471157944,
          1.0000000936622973, 0.9999997749296758, 1.0000000936622973, 1.0000001471157944, 0.9999997838941594, 1.0000000327477192, 1.0000001888501326, 0.9999998100735054, 0.9999999692244820,
          1.0000002155407750, 0.9999998513822845, 0.9999999081528108 },
      {0.9999999875698367, 0.9999999798867797, 1.0000000291702693, 0.9999999958349893, 0.9999999742962429, 1.0000000255580850, 1.0000000044319246, 0.9999999707532523, 1.0000000199099581,
          1.0000000126758153, 0.9999999695400410, 1.0000000126758153, 1.0000000199099581, 0.9999999707532523, 1.0000000044319246, 1.0000000255580850, 0.9999999742962429, 0.9999999958349893,
          1.0000000291702693, 0.9999999798867797, 0.9999999875698367 },
      {0.9999999983177603, 0.9999999972779716, 1.0000000039477668, 0.9999999994363271, 0.9999999965213747, 1.0000000034589107, 1.0000000005997958, 0.9999999960418831, 1.0000000026945199,
          1.0000000017154851, 0.9999999958776927, 1.0000000017154851, 1.0000000026945199, 0.9999999960418831, 1.0000000005997958, 1.0000000034589107, 0.9999999965213747, 0.9999999994363271,
          1.0000000039477668, 0.9999999972779716, 0.9999999983177603 } };

  @Test
  public void correctnessTest() {
    OGComplexMatrix c = new OGComplexMatrix(realP, imagP);
    ComplexType ans, tabans;
    final int rows = c.getNumberOfRows();
    final int cols = c.getNumberOfColumns();
    for (int i = 0; i < rows; i++) {
      for (int j = 0; j < cols; j++) {
        ans = new ComplexType(ZTAN.ztan(new double[] {c.getEntry(i, j).getReal(), c.getEntry(i, j).getImag() }));
        tabans = new ComplexType(answerReal[i][j], answerImag[i][j]);
        assertTrue(Math.abs(ans.getReal() - tabans.getReal()) < 100 * D1mach.four());
        assertTrue(Math.abs(ans.getImag() - tabans.getImag()) < 100 * D1mach.four());
      }
    }
  }

  @Test(expectedExceptions = MathsExceptionIllegalArgument.class)
  public void singularTan() {
    double real = MathsConstants.halfpi;
    double imag = 0.e0;
    new ComplexType(ZTAN.ztan(new double[] {real, imag }));
  }

  //TODO: this branch needs sharpening
  @Test
  public void fpbranchWarn() {
    double real = MathsConstants.halfpi - 100 * D1mach.four();
    double imag = 1e-4;
    ComplexType ans = new ComplexType(ZTAN.ztan(new double[] {real, imag }));
    ComplexType tabans = new ComplexType(new double[] { 2.226569275824151e-06,  1.000000003333333e+04});
    assertTrue(Math.abs(ans.getReal() - tabans.getReal()) < 100 * D1mach.four());
    assertTrue(Math.abs(ans.getImag() - tabans.getImag()) < 1e-4); // this value is really FP wobble dependent
  }
}
