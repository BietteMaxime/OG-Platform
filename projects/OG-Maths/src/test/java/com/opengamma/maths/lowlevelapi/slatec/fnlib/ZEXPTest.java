/**
 * Copyright (C) 2013 - present by OpenGamma Inc. and the OpenGamma group of companies
 * 
 * Please see distribution for license.
 */
package com.opengamma.maths.lowlevelapi.slatec.fnlib;

import static org.testng.Assert.assertTrue;

import org.testng.annotations.Test;

import com.opengamma.maths.commonapi.numbers.ComplexType;
import com.opengamma.maths.highlevelapi.datatypes.primitive.OGComplexMatrix;
import com.opengamma.maths.lowlevelapi.linearalgebra.blas.referenceblas.D1mach;

/**
 * Tests complex square root
 */
@Test
public class ZEXPTest {
  private static double[][] realP = { {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 },
      {-10.00, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00, 0.00, 1.00, 2.00, 3.00, 4.00, 5.00, 6.00, 7.00, 8.00, 9.00, 10.00 } };

  private static double[][] imagP = {
      {-10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00, -10.00 },
      {-9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00, -9.00 },
      {-8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00, -8.00 },
      {-7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00, -7.00 },
      {-6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00, -6.00 },
      {-5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00 },
      {-4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00, -4.00 },
      {-3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00, -3.00 },
      {-2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00, -2.00 },
      {-1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00, -1.00 },
      {0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00 },
      {1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00 },
      {2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00 },
      {3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00, 3.00 },
      {4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00, 4.00 },
      {5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00, 5.00 },
      {6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00, 6.00 },
      {7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00, 7.00 },
      {8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00, 8.00 },
      {9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00 },
      {10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00, 10.00 } };

  private static double[][] answerReal = {
      {-0.0000380937884858, -0.0001035496530180, -0.0002814771401422, -0.0007651341951751, -0.0020798503790770, -0.0056536194913587, -0.0153681311283823, -0.0417749115836575, -0.1135559830433394,
          -0.3086771652195129, -0.8390715290764524, -2.2808328902658661, -6.1999465993614278, -16.8532021784606201, -45.8117532330558959, -124.5292563432657573, -338.5056146294176074,
          -920.1536610785061612, -2501.2369762997668658, -6799.0670213455032354, -18481.7803345986503700 },
      {-0.0000413652498940, -0.0001124424071166, -0.0003056501520133, -0.0008308432540836, -0.0022584661198732, -0.0061391474138418, -0.0166879328572775, -0.0453625046404822, -0.1233080720576119,
          -0.3351860915765248, -0.9111302618846769, -2.4767088342402488, -6.7323926184992526, -18.3005405169183284, -49.7460267381175925, -135.2237205202628445, -367.5761822668549712,
          -999.1756568303418362, -2716.0410314005494001, -7382.9649810052760586, -20068.9795480161228625 },
      {-0.0000066056913154, -0.0000179561306669, -0.0000488098237013, -0.0001326788568176, -0.0003606585255081, -0.0009803715161676, -0.0026649260775372, -0.0072440201307560, -0.0196912882864254,
          -0.0535264711279387, -0.1455000338086135, -0.3955100979421309, -1.0751079122081517, -2.9224463013879611, -7.9440326757102406, -21.5941196670680355, -58.6989030925611246,
          -159.5601616269873659, -433.7294878966280294, -1178.9989854162513438, -3204.8515178286470473 },
      {0.0000342271093950, 0.0000930389295090, 0.0002529060314236, 0.0006874698695266, 0.0018687368539471, 0.0050797534322562, 0.0138082014479546, 0.0375345830796769, 0.1020295751242720,
          0.2773451400257055, 0.7539022543433046, 2.0493187984157144, 5.5706260504529617, 15.1425315660868645, 41.1616683929614098, 111.8890152216440299, 304.1458768811725122, 826.7542103268331175,
          2247.3509465334382185, 6108.9332401320807548, 16605.8022179204745044 },
      {0.0000435916635740, 0.0001184944269654, 0.0003221012475936, 0.0008755619682578, 0.0023800241880050, 0.0064695765015469, 0.0175861322419805, 0.0478040637062533, 0.1299449176992069,
          0.3532269084823603, 0.9601702866503661, 2.6100134424280030, 7.0947521125858781, 19.2855357450636156, 52.4235213679037955, 142.5019055182073657, 387.3603402909308215, 1052.9545740785492853,
          2862.2272849105543173, 7780.3404174920306104, 21149.1579760940512642 },
      {0.0000128782432963, 0.0000350066947348, 0.0000951580621721, 0.0002586664312337, 0.0007031282596549, 0.0019113007712960, 0.0051954541553336, 0.0141227086210353, 0.0383895022131823,
          0.1043534862696817, 0.2836621854632262, 0.7710737641656675, 2.0959958015330491, 5.6975072998337390, 15.4874305606508127, 42.0992010625383912, 114.4374932409418335, 311.0733583712569725,
          845.5850573783162645, 2298.5384958879762962, 6248.0754253858722223 },
      {-0.0000296753744769, -0.0000806660311933, -0.0002192730067666, -0.0005960458297653, -0.0016202205479798, -0.0044042160736693, -0.0119719005216626, -0.0325429996401548, -0.0884610445653820,
          -0.2404620499685837, -0.6536436208636119, -1.7767875768817303, -4.8298093832693851, -13.1287830814621582, -35.6877324801191307, -97.0093146996155014, -263.6986573392297259,
          -716.8072684342765797, -1948.4841722922592453, -5296.5291185821115505, -14397.4588569459592691 },
      {-0.0000449455898110, -0.0001221747800527, -0.0003321054845134, -0.0009027563036842, -0.0024539460558317, -0.0066705169715861, -0.0181323450702902, -0.0492888241119187, -0.1339809149295426,
          -0.3641978864132929, -0.9899924966004454, -2.6910786138197942, -7.3151100949011028, -19.8845308441469868, -54.0517588610781559, -146.9279139083189420, -399.3914784703783312,
          -1085.6585983674215186, -2951.1260398524786979, -8021.9922876232976705, -21806.0358634850163071 },
      {-0.0000188930371501, -0.0000513565995696, -0.0001396017113814, -0.0003794767952699, -0.0010315248769040, -0.0028039753284917, -0.0076219951828865, -0.0207187310022429, -0.0563193499921279,
          -0.1530918656742263, -0.4161468365471424, -1.1312043837568138, -3.0749323206393591, -8.3585326509353717, -22.7208474176192325, -61.7616666625049859, -167.8856161840321022,
          -456.3604197327042584, -1240.5162361873526606, -3372.0727427364899995, -9166.2440608226552285 },
      {0.0000245296867369, 0.0000666786017148, 0.0001812512313883, 0.0004926919286687, 0.0013392755167285, 0.0036405283004232, 0.0098959819250312, 0.0269000678415716, 0.0731219655980596,
          0.1987661103464130, 0.5403023058681398, 1.4686939399158854, 3.9923240484412719, 10.8522619141979586, 29.4995063590424813, 80.1879720842972290, 217.9735073777263494, 592.5134241903571137,
          1610.6184740946941929, 4378.1149307120422236, 11900.9502590597767266 },
      {0.0000453999297625, 0.0001234098040867, 0.0003354626279025, 0.0009118819655545, 0.0024787521766664, 0.0067379469990855, 0.0183156388887342, 0.0497870683678639, 0.1353352832366127,
          0.3678794411714423, 1.0000000000000000, 2.7182818284590455, 7.3890560989306504, 20.0855369231876679, 54.5981500331442362, 148.4131591025765999, 403.4287934927351102, 1096.6331584284585006,
          2980.9579870417283018, 8103.0839275753842230, 22026.4657948067178950 },
      {0.0000245296867369, 0.0000666786017148, 0.0001812512313883, 0.0004926919286687, 0.0013392755167285, 0.0036405283004232, 0.0098959819250312, 0.0269000678415716, 0.0731219655980596,
          0.1987661103464130, 0.5403023058681398, 1.4686939399158854, 3.9923240484412719, 10.8522619141979586, 29.4995063590424813, 80.1879720842972290, 217.9735073777263494, 592.5134241903571137,
          1610.6184740946941929, 4378.1149307120422236, 11900.9502590597767266 },
      {-0.0000188930371501, -0.0000513565995696, -0.0001396017113814, -0.0003794767952699, -0.0010315248769040, -0.0028039753284917, -0.0076219951828865, -0.0207187310022429, -0.0563193499921279,
          -0.1530918656742263, -0.4161468365471424, -1.1312043837568138, -3.0749323206393591, -8.3585326509353717, -22.7208474176192325, -61.7616666625049859, -167.8856161840321022,
          -456.3604197327042584, -1240.5162361873526606, -3372.0727427364899995, -9166.2440608226552285 },
      {-0.0000449455898110, -0.0001221747800527, -0.0003321054845134, -0.0009027563036842, -0.0024539460558317, -0.0066705169715861, -0.0181323450702902, -0.0492888241119187, -0.1339809149295426,
          -0.3641978864132929, -0.9899924966004454, -2.6910786138197942, -7.3151100949011028, -19.8845308441469868, -54.0517588610781559, -146.9279139083189420, -399.3914784703783312,
          -1085.6585983674215186, -2951.1260398524786979, -8021.9922876232976705, -21806.0358634850163071 },
      {-0.0000296753744769, -0.0000806660311933, -0.0002192730067666, -0.0005960458297653, -0.0016202205479798, -0.0044042160736693, -0.0119719005216626, -0.0325429996401548, -0.0884610445653820,
          -0.2404620499685837, -0.6536436208636119, -1.7767875768817303, -4.8298093832693851, -13.1287830814621582, -35.6877324801191307, -97.0093146996155014, -263.6986573392297259,
          -716.8072684342765797, -1948.4841722922592453, -5296.5291185821115505, -14397.4588569459592691 },
      {0.0000128782432963, 0.0000350066947348, 0.0000951580621721, 0.0002586664312337, 0.0007031282596549, 0.0019113007712960, 0.0051954541553336, 0.0141227086210353, 0.0383895022131823,
          0.1043534862696817, 0.2836621854632262, 0.7710737641656675, 2.0959958015330491, 5.6975072998337390, 15.4874305606508127, 42.0992010625383912, 114.4374932409418335, 311.0733583712569725,
          845.5850573783162645, 2298.5384958879762962, 6248.0754253858722223 },
      {0.0000435916635740, 0.0001184944269654, 0.0003221012475936, 0.0008755619682578, 0.0023800241880050, 0.0064695765015469, 0.0175861322419805, 0.0478040637062533, 0.1299449176992069,
          0.3532269084823603, 0.9601702866503661, 2.6100134424280030, 7.0947521125858781, 19.2855357450636156, 52.4235213679037955, 142.5019055182073657, 387.3603402909308215, 1052.9545740785492853,
          2862.2272849105543173, 7780.3404174920306104, 21149.1579760940512642 },
      {0.0000342271093950, 0.0000930389295090, 0.0002529060314236, 0.0006874698695266, 0.0018687368539471, 0.0050797534322562, 0.0138082014479546, 0.0375345830796769, 0.1020295751242720,
          0.2773451400257055, 0.7539022543433046, 2.0493187984157144, 5.5706260504529617, 15.1425315660868645, 41.1616683929614098, 111.8890152216440299, 304.1458768811725122, 826.7542103268331175,
          2247.3509465334382185, 6108.9332401320807548, 16605.8022179204745044 },
      {-0.0000066056913154, -0.0000179561306669, -0.0000488098237013, -0.0001326788568176, -0.0003606585255081, -0.0009803715161676, -0.0026649260775372, -0.0072440201307560, -0.0196912882864254,
          -0.0535264711279387, -0.1455000338086135, -0.3955100979421309, -1.0751079122081517, -2.9224463013879611, -7.9440326757102406, -21.5941196670680355, -58.6989030925611246,
          -159.5601616269873659, -433.7294878966280294, -1178.9989854162513438, -3204.8515178286470473 },
      {-0.0000413652498940, -0.0001124424071166, -0.0003056501520133, -0.0008308432540836, -0.0022584661198732, -0.0061391474138418, -0.0166879328572775, -0.0453625046404822, -0.1233080720576119,
          -0.3351860915765248, -0.9111302618846769, -2.4767088342402488, -6.7323926184992526, -18.3005405169183284, -49.7460267381175925, -135.2237205202628445, -367.5761822668549712,
          -999.1756568303418362, -2716.0410314005494001, -7382.9649810052760586, -20068.9795480161228625 },
      {-0.0000380937884858, -0.0001035496530180, -0.0002814771401422, -0.0007651341951751, -0.0020798503790770, -0.0056536194913587, -0.0153681311283823, -0.0417749115836575, -0.1135559830433394,
          -0.3086771652195129, -0.8390715290764524, -2.2808328902658661, -6.1999465993614278, -16.8532021784606201, -45.8117532330558959, -124.5292563432657573, -338.5056146294176074,
          -920.1536610785061612, -2501.2369762997668658, -6799.0670213455032354, -18481.7803345986503700 } };

  private static double[][] answerImag = {
      {0.0000246985202237, 0.0000671375387139, 0.0001824987514934, 0.0004960830399009, 0.0013484935127695, 0.0036655854115562, 0.0099640942148977, 0.0270852162414103, 0.0736252511289095,
          0.2001341822594486, 0.5440211108893698, 1.4788027000286772, 4.0198025073641253, 10.9269561097620098, 29.7025462335356103, 80.7398916855845101, 219.4737804006759063, 596.5915890863682307,
          1621.7040756249805327, 4408.2487199093584422, 11982.8623906574557623 },
      {-0.0000187101502838, -0.0000508594615242, -0.0001382503500664, -0.0003758034143636, -0.0010215395923374, -0.0027768325109023, -0.0075482133550601, -0.0205181712003919, -0.0557741719272369,
          -0.1516099180471587, -0.4121184852417566, -1.1202541896047342, -3.0451666068576628, -8.2776210520514741, -22.5009068886615644, -61.1638063192976844, -166.2604632771354147,
          -451.9427961174196184, -1228.5078901889528424, -3339.4306740191909739, -9077.5137185851090180 },
      {-0.0000449167949066, -0.0001220965073873, -0.0003318927173493, -0.0009021779425685, -0.0024523739073205, -0.0066662434288565, -0.0181207283767451, -0.0492572466649483, -0.1338950785292539,
          -0.3639645588861677, -0.9893582466233818, -2.6893545436324415, -7.3104235862398337, -19.8717915928141444, -54.0171299856719145, -146.8337828655621706, -399.1356037673587593,
          -1084.9630588118409378, -2949.2353673175698532, -8016.8529068280877254, -21792.0655780598681304 },
      {-0.0000298271454367, -0.0000810785874355, -0.0002203944509029, -0.0005990942309827, -0.0016285069616148, -0.0044267408812766, -0.0120331292968710, -0.0327094367071827, -0.0889134674202661,
          -0.2416918627937948, -0.6569865987187891, -1.7858747328383993, -4.8545108341787717, -13.1959285866057172, -35.8702528866135708, -97.5054566039122932, -265.0473108620167864,
          -720.4732887981558633, -1958.4494488301531874, -5323.6175487106384026, -14471.0928443258144398 },
      {0.0000126854439928, 0.0000344826118915, 0.0000937334573025, 0.0002547939537040, 0.0006926017743549, 0.0018826868175874, 0.0051176733649273, 0.0139112785118707, 0.0378147755894509,
          0.1027912173320610, 0.2794154981989259, 0.7595300713439713, 2.0646167911025195, 5.6122103059854025, 15.2555692922506978, 41.4689367899228856, 112.7242573215641670, 306.4163003037493240,
          832.9258610593317371, 2264.1272325711847770, 6154.5359136175184176 },
      {0.0000435350947172, 0.0001183406568701, 0.0003216832571380, 0.0008744257523978, 0.0023769356330795, 0.0064611809388167, 0.0175633107363714, 0.0477420284222580, 0.1297762883139992,
          0.3527685262888061, 0.9589242746631385, 2.6066264306850799, 7.0855452601123137, 19.2605089252874215, 52.3554914184820461, 142.3169809429032284, 386.8576631782460709, 1051.5881560175562299,
          2858.5129755252787618, 7770.2438777847601159, 21121.7127356774617510 },
      {0.0000343587801311, 0.0000933968476783, 0.0002538789538792, 0.0006901145469580, 0.0018759258325511, 0.0050992951021604, 0.0138613212141530, 0.0376789775748659, 0.1024220800566737,
          0.2784120790510337, 0.7568024953079282, 2.0572024707280034, 5.5920560936409816, 15.2007844630679543, 41.3200161842801990, 112.3194491453625261, 305.3159175943687842, 829.9347107360719065,
          2255.9964430012787489, 6132.4341360786183941, 16669.6842763244530943 },
      {-0.0000064068384540, -0.0000174155925474, -0.0000473404887534, -0.0001286847903287, -0.0003498015271496, -0.0009508591348179, -0.0025847031075998, -0.0070259514893501, -0.0190985162611352,
          -0.0519151497031734, -0.1411200080598672, -0.3836039535411311, -1.0427436562359045, -2.8344711324870042, -7.7048913727311543, -20.9440662087459657, -56.9318745892772853,
          -154.7568801561417047, -420.6728151574542380, -1143.5072691692187163, -3108.3750304935133499 },
      {-0.0000412820393111, -0.0001122162173011, -0.0003050353043479, -0.0008291719248475, -0.0022539229759813, -0.0061267978683562, -0.0166543633121944, -0.0452712531560930, -0.1230600248057767,
          -0.3345118292392623, -0.9092974268256817, -2.4717266720048192, -6.7188496974282499, -18.2637270406667653, -49.6459573345805651, -134.9517036790433906, -366.8367638303333820,
          -997.1657091307174596, -2710.5774270925076053, -7368.1133646968355606, -20028.6086692816425057 },
      {-0.0000382027236074, -0.0001038457693798, -0.0002822820678674, -0.0007673222155837, -0.0020857980351942, -0.0056697868969039, -0.0154120786930890, -0.0418943734502045, -0.1138807140643681,
          -0.3095598756531122, -0.8414709848078965, -2.2873552871788427, -6.2176763123679679, -16.9013965351500950, -45.9427590770791667, -124.8853671484961581, -339.4736241601933102,
          -922.7849837957890031, -2508.3896530269680625, -6818.5100125178960297, -18534.6318641934558400 },
      {0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000,
          0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000, 0.0000000000000000,
          0.0000000000000000, 0.0000000000000000, 0.0000000000000000 },
      {0.0000382027236074, 0.0001038457693798, 0.0002822820678674, 0.0007673222155837, 0.0020857980351942, 0.0056697868969039, 0.0154120786930890, 0.0418943734502045, 0.1138807140643681,
          0.3095598756531122, 0.8414709848078965, 2.2873552871788427, 6.2176763123679679, 16.9013965351500950, 45.9427590770791667, 124.8853671484961581, 339.4736241601933102, 922.7849837957890031,
          2508.3896530269680625, 6818.5100125178960297, 18534.6318641934558400 },
      {0.0000412820393111, 0.0001122162173011, 0.0003050353043479, 0.0008291719248475, 0.0022539229759813, 0.0061267978683562, 0.0166543633121944, 0.0452712531560930, 0.1230600248057767,
          0.3345118292392623, 0.9092974268256817, 2.4717266720048192, 6.7188496974282499, 18.2637270406667653, 49.6459573345805651, 134.9517036790433906, 366.8367638303333820, 997.1657091307174596,
          2710.5774270925076053, 7368.1133646968355606, 20028.6086692816425057 },
      {0.0000064068384540, 0.0000174155925474, 0.0000473404887534, 0.0001286847903287, 0.0003498015271496, 0.0009508591348179, 0.0025847031075998, 0.0070259514893501, 0.0190985162611352,
          0.0519151497031734, 0.1411200080598672, 0.3836039535411311, 1.0427436562359045, 2.8344711324870042, 7.7048913727311543, 20.9440662087459657, 56.9318745892772853, 154.7568801561417047,
          420.6728151574542380, 1143.5072691692187163, 3108.3750304935133499 },
      {-0.0000343587801311, -0.0000933968476783, -0.0002538789538792, -0.0006901145469580, -0.0018759258325511, -0.0050992951021604, -0.0138613212141530, -0.0376789775748659, -0.1024220800566737,
          -0.2784120790510337, -0.7568024953079282, -2.0572024707280034, -5.5920560936409816, -15.2007844630679543, -41.3200161842801990, -112.3194491453625261, -305.3159175943687842,
          -829.9347107360719065, -2255.9964430012787489, -6132.4341360786183941, -16669.6842763244530943 },
      {-0.0000435350947172, -0.0001183406568701, -0.0003216832571380, -0.0008744257523978, -0.0023769356330795, -0.0064611809388167, -0.0175633107363714, -0.0477420284222580, -0.1297762883139992,
          -0.3527685262888061, -0.9589242746631385, -2.6066264306850799, -7.0855452601123137, -19.2605089252874215, -52.3554914184820461, -142.3169809429032284, -386.8576631782460709,
          -1051.5881560175562299, -2858.5129755252787618, -7770.2438777847601159, -21121.7127356774617510 },
      {-0.0000126854439928, -0.0000344826118915, -0.0000937334573025, -0.0002547939537040, -0.0006926017743549, -0.0018826868175874, -0.0051176733649273, -0.0139112785118707, -0.0378147755894509,
          -0.1027912173320610, -0.2794154981989259, -0.7595300713439713, -2.0646167911025195, -5.6122103059854025, -15.2555692922506978, -41.4689367899228856, -112.7242573215641670,
          -306.4163003037493240, -832.9258610593317371, -2264.1272325711847770, -6154.5359136175184176 },
      {0.0000298271454367, 0.0000810785874355, 0.0002203944509029, 0.0005990942309827, 0.0016285069616148, 0.0044267408812766, 0.0120331292968710, 0.0327094367071827, 0.0889134674202661,
          0.2416918627937948, 0.6569865987187891, 1.7858747328383993, 4.8545108341787717, 13.1959285866057172, 35.8702528866135708, 97.5054566039122932, 265.0473108620167864, 720.4732887981558633,
          1958.4494488301531874, 5323.6175487106384026, 14471.0928443258144398 },
      {0.0000449167949066, 0.0001220965073873, 0.0003318927173493, 0.0009021779425685, 0.0024523739073205, 0.0066662434288565, 0.0181207283767451, 0.0492572466649483, 0.1338950785292539,
          0.3639645588861677, 0.9893582466233818, 2.6893545436324415, 7.3104235862398337, 19.8717915928141444, 54.0171299856719145, 146.8337828655621706, 399.1356037673587593, 1084.9630588118409378,
          2949.2353673175698532, 8016.8529068280877254, 21792.0655780598681304 },
      {0.0000187101502838, 0.0000508594615242, 0.0001382503500664, 0.0003758034143636, 0.0010215395923374, 0.0027768325109023, 0.0075482133550601, 0.0205181712003919, 0.0557741719272369,
          0.1516099180471587, 0.4121184852417566, 1.1202541896047342, 3.0451666068576628, 8.2776210520514741, 22.5009068886615644, 61.1638063192976844, 166.2604632771354147, 451.9427961174196184,
          1228.5078901889528424, 3339.4306740191909739, 9077.5137185851090180 },
      {-0.0000246985202237, -0.0000671375387139, -0.0001824987514934, -0.0004960830399009, -0.0013484935127695, -0.0036655854115562, -0.0099640942148977, -0.0270852162414103, -0.0736252511289095,
          -0.2001341822594486, -0.5440211108893698, -1.4788027000286772, -4.0198025073641253, -10.9269561097620098, -29.7025462335356103, -80.7398916855845101, -219.4737804006759063,
          -596.5915890863682307, -1621.7040756249805327, -4408.2487199093584422, -11982.8623906574557623 } };

  @Test
  public void correctnessTest() {
    OGComplexMatrix c = new OGComplexMatrix(realP, imagP);
    ComplexType tabans;
    final int rows = c.getNumberOfRows();
    final int cols = c.getNumberOfColumns();
    double[] rans = new double[1], ians = new double[1];
    for (int i = 0; i < rows; i++) {
      for (int j = 0; j < cols; j++) {
        rans[0]=0;
        ians[0]=0;        
        ZEXP.zexp(c.getEntry(i, j).getReal(), c.getEntry(i, j).getImag(), rans, ians);
        tabans = new ComplexType(answerReal[i][j], answerImag[i][j]);
        assertTrue(Math.abs(rans[0] - tabans.getReal()) < 10 * D1mach.four());
        assertTrue(Math.abs(ians[0] - tabans.getImag()) < 10 * D1mach.four());
      }
    }
  }
}
