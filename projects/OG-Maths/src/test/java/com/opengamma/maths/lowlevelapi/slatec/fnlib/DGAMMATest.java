/**
 * Copyright (C) 2013 - present by OpenGamma Inc. and the OpenGamma group of companies
 * 
 * Please see distribution for license.
 */
package com.opengamma.maths.lowlevelapi.slatec.fnlib;

import org.testng.annotations.Test;
import static org.testng.Assert.assertTrue;

import com.opengamma.maths.lowlevelapi.exposedapi.SLATEC;
import com.opengamma.maths.lowlevelapi.functions.FPEquals;

/**
 * tests dgamma
 */
@Test
public class DGAMMATest {

  private double[] input = new double[] {-20.5, -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5, -9.5, -8.5, -7.5, -6.5, -5.5, -4.5, -3.5, -2.5, -1.5, -0.5, 0.5, 1.5, 2.5, 3.5,
      4.5, 5.5, 6.5, 7.5, 8.5, 9.5, 10.5, 11.5, 12.5, 13.5, 14.5, 15.5, 16.5, 17.5, 18.5, 19.5, 20.5 };

  private double[] expected = new double[] {//
  -2.8346565743913348714004232802596119864680419702181098008802705528481814916322916196225482330589083161067626902843963631319e-19, //
      5.8110459775022364863708677245322045722594860389471250918045546333387720578461978202262238777707620480188635150830125444172e-18, //
      -1.1331539656129361148423192062837798915905997775946893929018881535010605512800085749441136561652985993636783854411874461620e-16, //
      2.0963348363839318124582905316249927994426095885501753768684930839769620198680158636466102639058024088228050130661967753977e-15, //
      -3.6685859636718806718020084303437373990245667799628069095198628969596835347690277613815679618351542154399087728658443569496e-14, //
      6.0531668400586031084733139100671667083905351869386314007077737799834778323688958062795871370280044554758494752286431889614e-13, //
      -9.3824086020908348181336365606041083980053295397548786710970493589743906401717884997333600623934069059875666866043969428973e-12, //
      1.3604492473031710486293773012875957177107727832644574073090721570512866428249093324613372090470440013681971695576375567194e-10, //
      -1.8366064838592809156496593567382542189095432574070174998672474120192369678136275988228052322135094018470661789028107015721e-9, //
      2.2957581048241011445620741959228177736369290717587718748340592650240462097670344985285065402668867523088327236285133769638e-8, //
      -2.6401218205477163162463853253112404396824684325225876560591681547776531412320896733077825213069197651551576321727903835110e-7, //
      2.7721279115751021320587045915768024616665918541487170388621265625165357982936941569731716473722657534129155137814299026837e-6, //
      -2.6335215159963470254557693619979623385832622614412811869190202343907090083790094491245130650036524657422697380923584075507e-5, //
      2.2384932885968949716374039576982679877957729222250890088811671992321026571221580317558361052531045958809292773785046464175e-4, //
      -1.6788699664476712287280529682737009908468296916688167566608753994240769928416185238168770789398284469106969580338784848141e-3, //
      1.0912654781909862986732344293779056440504392995847308918295690096256500453470520404809701013108884904919530227220210151283e-2, //
      -6.0019601300504246427027893615784810422774161477160199050626295529410752494087862226453355572098866977057416249711155832085e-2, //
      2.7008820585226910892162552127103164690248372664722089572781832988234838622339538001904010007444490139675837312370020124430e-1, //
      -9.4530872048294188122568932444861076415869304326527313504736415458821935178188383006664035026055715488865430593295070435547e-1, //
      2.3632718012073547030642233111215269103967326081631828376184103864705483794547095751666008756513928872216357648323767608882, //
      -3.5449077018110320545963349666822903655950989122447742564276155797058225691820643627499013134770893308324536472485651413340, //
      1.7724538509055160272981674833411451827975494561223871282138077898529112845910321813749506567385446654162268236242825706662, //
      8.8622692545275801364908374167057259139877472806119356410690389492645564229551609068747532836927233270811341181214128533310e-1, //
      1.3293403881791370204736256125058588870981620920917903461603558423896834634432741360312129925539084990621701177182119279990, //
      3.3233509704478425511840640312646472177454052302294758654008896059742086586081853400780324813847712476554252942955298199984, //
      1.1631728396567448929144224109426265262108918305803165528903113620909730305128648690273113684846699366793988530034354369993e1, //
      5.2342777784553520181149008492418193679490132376114244880064011294093786373078919106229011581810147150572948385154594664978e1, //
      2.8788527781504436099631954670830006523719572806862834684035206211751582505193405508425956369995580932815121611835027065726e2, //
      1.8712543057977883464760770536039504240417722324460842544622884037638528628375713580476871640497127606329829047692767592732e3, //
      1.4034407293483412598570577902029628180313291743345631908467163028228896471281785185357653730372845704747371785769575694548e4, //
      1.1929246199460900708784991216725183953266297981843787122197088573994562000589517407554005670816918849035266017904139340365e5, //
      1.1332783889487855673345741655888924755602983082751597766087234145294833900560041537176305387276072906583502717008932373346e6, //
      1.1899423083962248457013028738683370993383132236889177654391595852559575595588043614035120656639876551912677852859378992012e7, //
      1.3684336546556585725564983049485876642390602072422554302550335230443511934926250156140388755135858034699579530788285840817e8, //
      1.7105420683195732156956228811857345802988252590528192878187919038054389918657812695175485943919822543374474413485357301016e9, //
      2.3092317922314238411890908896007416834034140997213060385553690701373426390188047138486906024291760433555540458205232356374e10, //
      3.3483860987355645697241817899210754409349504445958937559052851516991468265772668350806013735223052628655533664397586916747e11, //
      5.1899984530401250830724817743776669334491731891236353216531919851336775811947635943749321289595731574416077179816259720953e12, //
      8.5634974475162063870695949277231504401911357620539982807277667754705680089713599307186380127832957097786527346696828539555e13, //
      1.4986120533153361177371791123515513270334487583594496991273591857073494015699879878757616522370767492112642285671944994422e15, //
      2.7724322986333718178137813578503699550118802029649819433856144935585963929044777775701590566385919860408388228493098239685e16, //
      5.4062429823350750447368736478082214122731663957817147896019482624392629661637316662618101604452543727796357045561541567385e17 };

  @Test
  public void gammaSmokeTest() {
    double ans;
    for (int i = 0; i < input.length; i++) {
      ans = SLATEC.getInstance().dgamma(input[i]);
      assertTrue(FPEquals.fuzzyEqualsDynamicTol(expected[i], ans));
    }
  }

}
